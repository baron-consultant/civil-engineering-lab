"use strict";var aptabase=(()=>{var a=Object.defineProperty;var w=Object.getOwnPropertyDescriptor;var y=Object.getOwnPropertyNames;var S=Object.prototype.hasOwnProperty;var I=(e,n)=>{for(var t in n)a(e,t,{get:n[t],enumerable:!0})},A=(e,n,t,o)=>{if(n&&typeof n=="object"||typeof n=="function")for(let s of y(n))!S.call(e,s)&&s!==t&&a(e,s,{get:()=>n[s],enumerable:!(o=w(n,s))||o.enumerable});return e};var E=e=>A(a({},"__esModule",{value:!0}),e);var k={};I(k,{init:()=>T,trackEvent:()=>$});var r,i,D=typeof window<"u"&&typeof window.fetch<"u",O=typeof chrome<"u"&&!!chrome.runtime?.id,p=g(),c=new Date,u={US:"https://us.aptabase.com",EU:"https://eu.aptabase.com",DEV:"https://localhost:3000",SH:""};function f(e){let n=new Date,t=n.getTime()-c.getTime();return Math.floor(t/1e3)>e&&(p=g()),c=n,p}function g(){let e=Math.floor(Date.now()/1e3).toString(),n=Math.floor(Math.random()*1e8).toString().padStart(8,"0");return e+n}function b(e){let n=e.split("-");return n.length!==3||u[n[1]]===void 0?(console.warn(`The Aptabase App Key "${e}" is invalid. Tracking will be disabled.`),!1):!0}function m(e,n){let t=e.split("-")[1];if(t==="SH"){if(!n?.host){console.warn("Host parameter must be defined when using Self-Hosted App Key. Tracking will be disabled.");return}return`${n.host}/api/v0/event`}return`${n?.host??u[t]}/api/v0/event`}async function v(e){if(!D&&!O){console.warn(`Aptabase: trackEvent requires a browser environment. Event "${e.eventName}" will be discarded.`);return}if(!e.appKey){console.warn(`Aptabase: init must be called before trackEvent. Event "${e.eventName}" will be discarded.`);return}try{let n=await fetch(e.apiUrl,{method:"POST",headers:{"Content-Type":"application/json","App-Key":e.appKey},credentials:"omit",body:JSON.stringify({timestamp:new Date().toISOString(),sessionId:e.sessionId,eventName:e.eventName,systemProps:{locale:e.locale??V(),isDebug:e.isDebug??N(),appVersion:e.appVersion??"",sdkVersion:e.sdkVersion},props:e.props})});if(n.status>=300){let t=await n.text();console.warn(`Failed to send event "${e.eventName}": ${n.status} ${t}`)}}catch(n){console.warn(`Failed to send event "${e.eventName}"`),console.warn(n)}}function V(){if(r)return r;if(!(typeof navigator>"u"))return navigator.languages.length>0?r=navigator.languages[0]:r=navigator.language,r}function N(){return i!==void 0||(i=!0),i}var x=1*60*60,U="aptabase-web@0.4.3",h="",d,l;function T(e,n){b(e)&&(d=n?.apiUrl??m(e,n),h=e,l=n)}async function $(e,n){if(!d)return;let t=f(x);await v({apiUrl:d,sessionId:t,appKey:h,isDebug:l?.isDebug,appVersion:l?.appVersion,sdkVersion:U,eventName:e,props:n})}return E(k);})();
//# sourceMappingURL=aptabase.min.js.map