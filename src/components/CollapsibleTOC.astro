---
import DefaultTableOfContents from '@astrojs/starlight/components/TableOfContents.astro';

const props = Astro.props;
---

<div class="toc-wrapper">
  <DefaultTableOfContents {...props} />
</div>

<button id="sidebar-toggle" aria-label="Toggle Sidebar">
  <span class="icon">ğŸ‘‰</span>
</button>

<script>
  const toggleBtn = document.getElementById('sidebar-toggle');

  if (toggleBtn) {
    // [í•µì‹¬ í•´ê²°ì±…] 
    // ë²„íŠ¼ì„ ì‚¬ì´ë“œë°” ê°ì˜¥ì—ì„œ íƒˆì¶œì‹œì¼œ 'body' íƒœê·¸ ì§ì†ìœ¼ë¡œ ì˜®ê¹ë‹ˆë‹¤.
    // ê·¸ë˜ì•¼ ì‚¬ì´ë“œë°”ê°€ ì‚¬ë¼ì ¸ë„ ë²„íŠ¼ì€ ì‚´ì•„ë‚¨ìŠµë‹ˆë‹¤.
    document.body.appendChild(toggleBtn);

    toggleBtn.addEventListener('click', () => {
      // 1. bodyì— í´ë˜ìŠ¤ í† ê¸€
      document.body.classList.toggle('hide-right-sidebar');
      
      // 2. ì•„ì´ì½˜ ë°©í–¥ ë³€ê²½
      const icon = toggleBtn.querySelector('.icon');
      if (icon) {
        if (document.body.classList.contains('hide-right-sidebar')) {
          icon.textContent = 'ğŸ‘ˆ'; // ëŒì•„ì˜¤ê¸°
        } else {
          icon.textContent = 'ğŸ‘‰'; // ë„“ê²Œ ë³´ê¸°
        }
      }
    });
  }
</script>

<style is:global>
  /* [ë²„íŠ¼ ìŠ¤íƒ€ì¼] */
  #sidebar-toggle {
    position: fixed; /* í™”ë©´ ê¸°ì¤€ ê³ ì • */
    top: 5rem;
    right: 1.5rem;   /* ìŠ¤í¬ë¡¤ë°” ê³ ë ¤ ìœ„ì¹˜ */
    z-index: 9999;   /* ì–´ë–¤ ìš”ì†Œë³´ë‹¤ ìœ„ì— ìˆê²Œ ì•„ì£¼ ë†’ê²Œ ì„¤ì • */
    background-color: var(--sl-color-bg-nav);
    border: 1px solid var(--sl-color-gray-5);
    border-radius: 50%;
    width: 40px;
    height: 40px;
    cursor: pointer;
    font-size: 1.2rem;
    box-shadow: 0 4px 6px rgba(0,0,0,0.2);
    display: flex;
    align-items: center;
    justify-content: center;
    transition: transform 0.2s, background-color 0.2s;
  }
  
  #sidebar-toggle:hover {
    transform: scale(1.1);
    background-color: var(--sl-color-gray-6);
  }

  /* =========================================
     [ë ˆì´ì•„ì›ƒ ê°•ì œ ì¡°ì •]
     ========================================= */

  /* 1. ìš°ì¸¡ ì‚¬ì´ë“œë°” ì˜ì—­ ìˆ¨ê¸°ê¸° */
  body.hide-right-sidebar .right-sidebar,
  body.hide-right-sidebar aside, 
  body.hide-right-sidebar .right-sidebar-panel {
    display: none !important;
  }

  /* 2. í™”ë©´ ë¶„í• (Grid) ë¹„ìœ¨ ì¬ì„¤ì • (ì˜¤ë¥¸ìª½ ê³µê°„ ì‚­ì œ) */
  @media (min-width: 72rem) {
    body.hide-right-sidebar .sl-container {
      grid-template-columns: var(--sl-sidebar-width) 1fr !important; 
    }
    body.hide-right-sidebar .page {
      grid-template-columns: var(--sl-sidebar-width) 1fr !important;
    }
  }

  /* 3. ë³¸ë¬¸ ì˜ì—­(main) ë„ˆë¹„ 100% ê°•ì œ */
  body.hide-right-sidebar main,
  body.hide-right-sidebar .main-pane {
    margin-right: 0 !important;
    width: 100% !important;
    max-width: 100% !important;
  }
</style>