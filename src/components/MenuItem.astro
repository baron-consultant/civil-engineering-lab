---
import type { MenuItem } from '../lib/sidebarConfig';

interface Props {
  item: MenuItem;
  activeMenu: string;
  groupId: string;
  depth?: number;
}

const { item, activeMenu, groupId, depth = 2 } = Astro.props;
const hasChildren = item.children && item.children.length > 0;
const isActive = activeMenu === item.id || activeMenu.includes(item.id);
const depthClass = `depth0${depth}`;
---

<li class={isActive ? 'active' : ''}>
  {hasChildren ? (
    <>
      <a href={`javascript:toggleGroup('${groupId}')`}>
        {depth === 1 && <i class="ico-arrow"></i>}
        <span>{item.label}</span>
      </a>
      <ul 
        class={isActive ? depthClass : `${depthClass} d-none`} 
        id={groupId}
      >
        {item.children!.map((child, idx) => (
          <MenuItem 
            item={child} 
            activeMenu={activeMenu} 
            groupId={`${groupId}_${idx}`}
            depth={depth + 1}
          />
        ))}
      </ul>
    </>
  ) : item.href ? (
    <a href={item.href}>
      <span>{item.label}</span>
    </a>
  ) : (
    <span>{item.label}</span>
  )}
</li>